(self.webpackChunkedu_core_dev=self.webpackChunkedu_core_dev||[]).push([[207,623],{1207:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>o});var s=e(623),a=e(579);const o=function(){return(0,a.jsxs)("div",{style:{margin:50},children:[(0,a.jsx)(s.default,{step:"2",language:"bash",code:"cd ~/code\nsplunk-create"}),(0,a.jsx)(s.default,{step:"6",language:"jsx",code:"import React from 'react';\nimport { StyledContainer } from './ShippingStyles';\nconst Shipping = () => {\n\treturn (\n\t\t<StyledContainer>\n\t\t</StyledContainer>\n\t);\n};\nexport default Shipping;"}),(0,a.jsx)(s.default,{step:"9",language:"jsx",code:"import styled from 'styled-components';\nimport { variables, mixins } from '@splunk/themes';\n\nconst StyledContainer = styled.div`\n\t${mixins.reset('inline')};\n\tdisplay: block;\n\tfont-size: ${variables.fontSizeLarge};\n\tmargin-top: '6px';\n\tmargin-bottom: ${variables.spacingXXLarge};\n\tmargin-left: ${variables.spacingXXLarge};\n\tmargin-right: ${variables.spacingXXLarge};\n`;\n\nconst vizContainer = {\n\tflex: '1',\n\tborder: '1px solid #d3d3d3',\n\toverflowX: 'auto',\n\twidth: '1200px',\n\theight: '600px',\n\tposition: 'relative',\n};\n\nconst sectionTitle = {\n\tfontSize: '22px',\n\tmarginBottom: '0px',\n\tmarginBottom: '20px',\n};\n\nexport {\n\tStyledContainer,\n\tvizContainer,\n\tsectionTitle,\n};"}),(0,a.jsx)(s.default,{step:"12",language:"jsx",code:", { useMemo, useState, useEffect }"}),(0,a.jsx)(s.default,{step:"13",language:"jsx",code:"import Map from '@splunk/visualizations/Map';\nimport { MapContextProvider, testTileConfig } from '@splunk/visualization-context/MapContext';"}),(0,a.jsx)(s.default,{step:"14",language:"jsx",code:"import SearchJob from '@splunk/search-job';\nimport WaitSpinner from '@splunk/react-ui/WaitSpinner';"}),(0,a.jsx)(s.default,{step:"15",language:"jsx",code:", vizContainer, sectionTitle"}),(0,a.jsx)(s.default,{step:"16",language:"jsx",code:'const SEARCH_TIME_RANGE = { earliest_time: "-24h@h", latest_time: "now" };'}),(0,a.jsx)(s.default,{step:"17",language:"jsx",code:"const [mapResults, setMapResults] = useState({ fields: [], results: [] });\nconst [loadingMap, setLoadingMap] = useState(true);\nconst [error, setError] = useState(null);"}),(0,a.jsx)(s.default,{step:"18",language:"jsx",code:"const safeConfig = useMemo(() => {\n\tconst defaultConfig = {\n\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n\t\tattribution: '\xa9 OpenStreetMap contributors',\n\t\tmaxZoom: 18,\n\t\tminZoom: 1,\n\t\tsubdomains: ['a', 'b', 'c'],\n\t\tzoomConstraints: {\n\t\t\tminZoom: 1,\n\t\t\tmaxZoom: 18\n\t\t}\n\t};\n\tconst config = testTileConfig || defaultConfig;\n\tif (!config.zoomConstraints) {\n\t\tconfig.zoomConstraints = {\n\t\t\tminZoom: config.minZoom || 1,\n\t\t\tmaxZoom: config.maxZoom || 18\n\t\t};\n\t}\n\treturn config;\n}, []);"}),(0,a.jsx)(s.default,{step:"19",language:"jsx",code:"const contextValue = useMemo(() => ({\n\tdefaultTileConfig: safeConfig,\n\t...(testTileConfig && { testTileConfig })\n}), [safeConfig]);"}),(0,a.jsx)(s.default,{step:"20",language:"jsx",code:'// ==== SEARCH ====\n// ==== Map Search ====\nuseEffect(() => {\n\tsetLoadingMap(true);\n\tsetError(null);\n\t\n\tconst mapSearch = SearchJob.create({\n\t\tsearch: `index=bccscm | eval location_info="Vendor: "+vendor+",\n\t\t\tRoast: "+Roast+", shipDate: "+shipDate | geostats latfield=Latitude\n\t\t\tlongfield=Longitude sum(Amount) by location_info limit=10000`,\n\t\t...SEARCH_TIME_RANGE,\n\t});\n\n\tconst subscription = mapSearch.getResults().subscribe({\n\t\tnext: (results) => { /* handle success */ },\n\t\terror: (err) => { /* handle errors */ },\n\t});\n\n\treturn () => subscription.unsubscribe();\n}, []);'}),(0,a.jsx)(s.default,{step:"21",language:"jsx",code:"\tconst transformDataForMap = (results) => {\n\t\tif (!results?.results?.length || !results?.fields?.length) {\n\t\t\treturn {\n\t\t\t\tfields: [],\n\t\t\t\tcolumns: []\n\t\t\t};\n\t\t}\n\n\t\tconst fieldNames = results.fields.map(field => field.name);\n\t\tconst columns = fieldNames.map(fieldName => {\n\t\tconst field = results.fields.find(f => f.name === fieldName);\n\t\treturn results.results.map(row => {\n\t\t\tconst value = row[fieldName];\n\t\t\tif (field?.type === 'number' && !['lat', 'lon', 'Latitude', 'Longitude', '_geo'].includes(fieldName)) {\n\t\t\t\treturn formatNumber(value);\n\t\t\t}\n\t\t\treturn value;\n\t\t});\n\t});\n\n\treturn {\n\t\tfields: results.fields,\n\t\tcolumns: columns\n\t};\n};"}),(0,a.jsx)(s.default,{step:"22",language:"jsx",code:"const transformedData = useMemo(() => transformDataForMap(mapResults), [mapResults]);"}),(0,a.jsx)(s.default,{step:"23",language:"jsx",code:"const latField = transformedData.fields?.find(f =>\n\t['Latitude', 'lat', '_lat'].includes(f.name)\n)?.name || 'Latitude';\n\nconst lonField = transformedData.fields?.find(f =>\n\t['Longitude', 'lon', '_lon'].includes(f.name)\n)?.name || 'Longitude';\n\nconst valueField = transformedData.fields?.find(f =>\n\tf.type === 'number' && !['lat', 'lon', 'Latitude', 'Longitude', '_lat', '_lon', '_geo'].includes(f.name)\n)?.name || 'count';"}),(0,a.jsx)(s.default,{step:"24",language:"jsx",code:"{/* ===== Map ===== */}\n<h1 style={sectionTitle}>Shipments</h1>\n<div style={vizContainer}>\n</div>"}),(0,a.jsx)(s.default,{step:"25",language:"jsx",code:"<MapContextProvider value={contextValue}>\n\t{loadingMap ? (\n\t\t<WaitSpinner size=\"medium\" label=\"Loading map data...\" />\n\t) : (\n\t<>\n\t\t<Map\n\t\t\toptions={{\n\t\t\t\tcenter: [14.1615, -21.0599],\n\t\t\t\tzoom: 1.2,\n\t\t\t\tlayers: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'bubble',\n\t\t\t\t\t\tlatitudeField: 'lat',\n\t\t\t\t\t\tlongitudeField: 'lon',\n\t\t\t\t\t\tvalueField: transformedData.fields?.find(f =>\n\t\t\t\t\t\t\tf.type === 'number' && !['lat', 'lon', 'Latitude', 'Longitude'].includes(f.name)\n\t\t\t\t\t\t)?.name || 'count',\n\t\t\t\t\t\tseriesColors: ['#008000', '#800080', '#FF6B35'],\n\t\t\t\t\t\topacity: 0.8,\n\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\t\tformat: customTooltipContent,\n\t\t\t\t\t\t\texcludeFields: ['lat', 'lon', 'Latitude', 'Longitude', '_lat', '_lon']\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tshowLegend: true,\n\t\t\t\tshowTooltip: true,\n\t\t\t\ttooltip: {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tformat: customTooltipContent,\n\t\t\t\t\texcludeFields: ['lat', 'lon', 'Latitude', 'Longitude', '_lat', '_lon']\n\t\t\t\t}\n\t\t\t}}\n\t\t\tdataSources={{\n\t\t\t\tprimary: {\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\tcount: 10000,\n\t\t\t\t\t\tsearch: 'index=bccscm sourcetype=scm:logistics | geostats latfield=Latitude longfield=Longitude sum(Amount) by Roast'\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: transformedData.fields || [],\n\t\t\t\t\t\tcolumns: transformedData.columns || [],\n\t\t\t\t\t},\n\t\t\t\t\tmeta: {\n\t\t\t\t\t\ttotalCount: mapResults.results?.length || 0,\n\t\t\t\t\t\tdone: true\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}}\n\t\t\twidth=\"100%\"\n\t\t\theight=\"100%\"\n\t\t/>\n\t\t{(!mapResults?.results?.length) && (\n\t\t\t<div style={{ position: 'absolute', top: '50%', left: '50%', transform:'translate(-50%, -50%)' }}>\n\t\t\t\tNo data available - check console for search results\n\t\t\t</div>\n\t\t)}\n\t</>\n\t)}\n</MapContextProvider>"}),(0,a.jsx)(s.default,{step:"28",language:"js",code:"'@splunk/shipping': path.resolve(__dirname, '../shipping/src/Shipping.jsx'),"}),(0,a.jsx)(s.default,{step:"31",language:"jsx",code:"import Shipping from '@splunk/shipping';"}),(0,a.jsx)(s.default,{step:"32",language:"jsx",code:"<Shipping />"})]})}},623:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>d});var s=e(5043),a=e(1045),o=e(9336),i=e(683),l=e(2999),r=e.n(l),u=(e(3817),e(6149),e(3636),e(337),e(3994),e(3839),e(4194),e(8496),e(7337),e(944),e(4608),e(579));const d=function(t){let{step:n,code:e,language:l}=t;return(0,s.useEffect)((()=>{r().highlightAll()}),[]),(0,u.jsxs)("div",{children:[(0,u.jsx)(o.A,{}),(0,u.jsxs)(i.A,{direction:"row",spacing:5,sx:{margin:3},children:[(0,u.jsx)(a.A,{sx:{bgcolor:"#f56a00",margin:2},children:n}),(0,u.jsx)("pre",{style:{width:"90%"},children:(0,u.jsx)("code",{className:`language-${l}`,children:e})})]})]})}},944:()=>{!function(t){var n=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+n.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+n.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+n.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+n.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:n,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css;var e=t.languages.markup;e&&(e.tag.addInlined("style","css"),e.tag.addAttribute("style","css"))}(Prism)},4608:()=>{}}]);
//# sourceMappingURL=207.68079007.chunk.js.map